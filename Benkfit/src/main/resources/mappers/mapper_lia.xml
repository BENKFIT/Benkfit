<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="spring.mvc.benkfit.persistence.DAO_lia">
  
  <!-- id 체크 -->
  <select id="id_check" parameterType="String" resultType="int">
    select count(*) from users_tbl where c_id=#{strId}
  </select>
  
  <!-- 실명확인 -->
  <select id="name_check" parameterType="java.util.Map" resultType="int">
    select count(*) from people_tbl where realName=#{name} and realJumin=#{jumin}
  </select>
  
  <!-- 회원가입 -->
  <insert id="insertMember" parameterType="spring.mvc.benkfit.vo.UsersVO">
    insert into users_tbl(c_id, c_pwd, c_name, c_address, c_post, c_hp, c_jumin1, c_jumin2, c_email, c_idCard) 
    values(#{c_id}, #{c_pwd}, #{c_name}, #{c_address}, #{c_post}, #{c_hp}, #{c_jumin1}, #{c_jumin2}, #{c_email}, #{c_idCard})
  </insert>
  
  <!-- 회원 로그인 -->
  <select id="user_login" parameterType="String" resultType="spring.mvc.benkfit.vo.UsersVO">
   select * from users_tbl where c_id=#{id}
  </select>
  
  <!-- 관리자 로그인 -->
  <select id="admin_login" parameterType="String" resultType="spring.mvc.benkfit.vo.AdminVO">
   select * from admin_tbl where admin_id=#{id}
  </select>
  
  <!-- 아이디 찾기 -->
  <select id="findMyId" parameterType="java.util.Map" resultType="String">
    select c_id from users_tbl where c_name=#{name} and c_email=#{email}
  </select>
  
  <!-- 비밀번호 찾기(조회) -->
  <select id="findMyPwd" parameterType="java.util.Map" resultType="int">
    select count(*) from users_tbl where c_id=#{id} and c_email=#{email}
  </select>
  
  <!-- 비밀번호 찾기(임시 비밀번호 생성) -->
  <update id="setTempPwd" parameterType="java.util.Map">
    update users_tbl set c_pwd=#{pwd} where c_id=#{id}
  </update>
  
  <!-- 상품 검색(카드 건수) -->
  <select id="search_card_count" parameterType="String" resultType="int">
    select count(*) from cardproduct_tbl where card_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(예금 건수) -->
  <select id="search_cheq_count" parameterType="String" resultType="int">
    select count(*) from cheqproduct_tbl where cheq_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(대출 건수) -->
  <select id="search_loan_count" parameterType="String" resultType="int">
    select count(*) from loanproduct_tbl where loan_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(적금 건수) -->
  <select id="search_sav_count" parameterType="String" resultType="int">
    select count(*) from savproduct_tbl where sav_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(카드) -->
  <select id="search_card" parameterType="String" resultType="spring.mvc.benkfit.vo.CardProductVO">
    select * from cardproduct_tbl where card_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(예금) -->
  <select id="search_cheq" parameterType="String" resultType="spring.mvc.benkfit.vo.CheqProductVO">
    select * from cheqproduct_tbl where cheq_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(대출) -->
  <select id="search_loan" parameterType="String" resultType="spring.mvc.benkfit.vo.LoanProductVO">
    select * from loanproduct_tbl where loan_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 상품 검색(적금) -->
  <select id="search_sav" parameterType="String" resultType="spring.mvc.benkfit.vo.SavProductVO">
    select * from savproduct_tbl where sav_name like '%'||#{keyword}||'%'
  </select>
  
  <!-- 관리자 > 회원조회 -->
  <select id="selectUsers" resultType="spring.mvc.benkfit.vo.UsersVO">
    select * from users_tbl order by c_regDate desc
  </select>
  
  <!-- 관리자 > 회원삭제 -->
  <delete id="deleteUsers" parameterType="String">
    delete from users_tbl where c_id=#{id}
  </delete>
  
  <!-- 관리자 > 회원 등급 수정 -->
  <update id="updateUsers" parameterType="java.util.Map">
    update users_tbl set c_level=#{level} where c_id=#{id}
  </update>
</mapper>